(function(){"use strict";function n(n){return"length"in n&&"number"===typeof n.length}function r(r){return n(r)?Array.prototype.slice.call(r):[r]}define("qix",function(){var n="qix-element-placeholder";var t=u.bind(null,"qix");function e(n){var t=document.createElement("div");t.innerHTML=n;return r(t.children)}function u(n,r){return i(r)[0]===n}function i(n){return n.name.split(":")}function o(n,r,t,e){var u=x(n)+":"+x(t);if(e===null)r.removeAttribute(u,e);else{e=e===void 0?"":e;r.setAttribute(u,e)}return e}function a(n,t){var e=x(n);return r(t.attributes).filter(u.bind(null,e)).reduce(function(n,r){var t=_(i(r)[1]);n[t]=r.value;return n},{})}function c(n){var r=i(n)[1];var t=n.value.split("#");return{name:_(r),module_path:t[0],module_prop:t[1]}}function f(n){return r(n.attributes).filter(t).map(c)}function l(n,r){for(var t in r)n[t]=r[t];return n}function d(r,t){if(t.length){var e=t.map(s.bind(null,"name"));r.setAttribute(n,e.join(","))}}function v(n){return n.reduce(function(n,t){var e=f(t);d(t,e);e.forEach(function(r){n[r.name]=r});return l(v(r(t.children)),n)},{})}function s(n,r){return r?r[n]:void 0}function p(n,r){return s(r,n)}function m(n,r,t){var u=e(t.text);var i=v(u);var o=Object.keys(i);var a=o.map(p.bind(null,i)).map(s.bind(null,"module_path"));t.require(a,function(){o.forEach(function(n,r){var e=i[n];var u=t.require(e.module_path);var o=e.module_prop?u[e.module_prop]:u;if(!o)throw new Error("No Factory for ctrl_def"+JSON.stringify(e,null,4));e.factory=o});var r={spawn:b.bind(null,u,i),spawn_into:h.bind(null,u,i)};n(r)},r)}function b(n,r,t){var e=n.map(y);var u=document.create("div");e.forEach(u.appendChild.bind(u));return e.reduce(function(n,e){return H(r,t,n,e)},{$root_elems:e})}function h(n,r,t,e){var u=b(n,r,t);u.$root_elems.forEach(e.appendChild.bind(e));return u}function y(n){return n.cloneNode(true)}function _(n){return n.replace(/-/g,"_")}function x(n){return n.replace(/_/g,"-")}function w(){}function g(){}function q(n,r){var t=n.name;var e=Object.create(n);e.get_attrs=a.bind(null,t,r);e.set_attr=o.bind(null,t,r);e.emit=w.bind(null);e.is_my_qix_event=g.bind(null);e.elem=r;return e}function T(n,r,t,e){var u=n.name;if(e[u])throw new Error("QIX#bind_controller: duplicate ctrl name:"+u);var i=q(n,t);e[u]=n.factory(t,r[u],i);e["$"+u]=i;return e}function A(n,r,t,e){var u=q({name:r,factory:n},t);var i={};i["$"+r]=u;i[r]=n(t,e,u);return i}function E(r,t,e,u){var i=u.getAttribute(n);var o=i.split(",");return o.reduce(function(n,e){return T(r[e],t,u,n)},e)}function O(r){return r.hasAttribute(n)}function X(t){return r(t.querySelectorAll("["+n+"]"))}function M(n){var r=X(n);if(O(n))r.unshift(n);return r}function H(n,r,t,e){return M(e).reduce(E.bind(null,n,r),t)}function j(){}return{load:function(n,r,t){r(["qix-seed!"+n],m.bind(null,t,j))},make:function(n,r,t){return m(r,t,n)},control:A}});define("qix-seed",function(){function n(n,r){if(r.startsWith("."))return n+r;else return r}function t(t,e,u,i){var o=t.substring(0,t.lastIndexOf("/")+1);var a=n.bind(null,o);e(["text!"+t],function(n){var t={text:n,require:function(n){if(Array.prototype.isPrototypeOf(n)){var t=r(arguments);t[0]=t[0].map(a);return require.apply(null,t)}else{var e=a(n);return require(e)}}};u(t)})}return{load:t}});define("text",function(){function n(n,r,e,u){var i=r.toUrl(n);t(i,e)}return{load:n}});function t(n,r){var t=u();if(!t)throw new Error("NO XHR!");t.responseType="text";t.open("GET",n,true);t.onreadystatechange=function(){if(t.readyState!=4)return;if(t.status!=200&&t.status!=304){throw new Error("get_remote_text HTTP error for ["+n+"] : "+t.status)}r(t.responseText)};if(t.readyState==4)return;t.send()}var e=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];function u(){var n=false;for(var r=0;r<e.length;r++){try{n=e[r]()}catch(t){continue}break}return n}})();
//# sourceMappingURL=qix.min.js.map
